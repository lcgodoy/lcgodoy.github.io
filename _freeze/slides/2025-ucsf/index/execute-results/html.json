{
  "hash": "931b3a5bbe37c32ceaf5a2f541d4fef8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: |\n  STATISTICAL INFERENCES AND PREDICTIONS FOR AREAL DATA AND SPATIAL DATA FUSION\n  WITH HAUSDORFF-GAUSSIAN PROCESSES\nsubtitle: |\n  Available at [lcgodoy.me/slides/2025-ucsf/](https://lcgodoy.me/slides/2025-ucsf/)\nauthor:\n  - name: Lucas da Cunha Godoy\n    orcid: 0000-0003-4265-972X\n    email: |\n      ldcgodoy@ucsc.com\n    affiliations: EEB Department, UCSC\ninstitute: Department of Epidemiology \\& Biostatistics -- UCSF\ndate: 2025-03-12\nbibliography: references.bib\ncsl: styles/asa.csl\ntitle-slide-attributes:\n  data-background-image: qr-code.png\n  data-background-size: 30%\n  data-background-position: 90% 90%\nformat:\n  revealjs:\n    theme: [styles/jsm.scss]\n    filters: [styles/appendix.lua]\n    embed-resources: true\n    self-contained-math: true\n    toc: true\n    toc-depth: 1\n    smaller: false\n    slide-number: c/t\n    navigation-mode: linear\n    html-math-method:\n      method: mathjax\n      url: \"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML\"\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n# Introduction {.section_slide visibility=\"uncounted\"}\n\n\n##  Spatial Statistics\n\n\\newcommand\\indicator{1\\kern-0.25em\\text{l}}\n\\newcommand\\REALS{1\\kern-0.2em\\text{R}}\n\\newcommand\\E{\\mathbb{E}}\n\\newcommand\\dd{\\mathrm{d}}\n\n\n\n::: {.cell}\n\n:::\n\n\n\n- Taking into account [spatial dependence]{.important} possibly present in data\n  is a foremost aspect of spatial statistics.\n\n- [General spatial model]{.important2} [@cressie1993statistics]: $\\{\n  Z(\\mathbf{s}) \\; : \\; \\mathbf{s} \\in D \\}$, where $D$ is an [index\n  set]{.important}.\n\n- Statistical [inference depends]{.important} heavily on the spatial\n  [structure/geometry]{.important} of the observed spatial data.\n\n| Geometry       | Branch              | Index set |\n|:--------------:|:-------------------:|:---------:|\n| Areas/polygons | Areal models        | Countable |\n| Points         | Geostatistics       | Continuum |\n| Mixed          | Spatial Data Fusion |           |\n\n: {.striped}\n\n\n::: {.notes}\n\n- Challenges arise when working with data from different sources:\n  \n  - Change of support\n  \n  - Spatial misalignment\n  \n  - Data fusion itself.\n\nLoosely speaking, this means the GP has stationary mean, variance, and a\ncorrelation function such that the correlation between two data points depends\nsolely on their distance.\n\n- Common assumptions are [stationarity]{.important} and\n  [isotropy]{.important}.\n\n- [Importance in spatial statistics:]{.important2} predominant foundation of\n  geostatistical modeling.\n\n- Completely specified by mean and covariance functions.\n\nThe main reasons these models are not applied to areal data are:\n\n1. Calculating distance between areal spatial units is non-trivial;\n    \n1. The commonly used areal models are computationally efficient.\n\n:::\n\n\n## Classic Models for Spatial Data\n\n* Areal data\n\n    * _CAR [@besag1974spatial], ICAR, BYM [@besag1991bayesian],\n      [DAGAR]{.important} [@datta2019spatial]_.\n\n* Point-referenced data\n\n    * _Gaussian processes (GP)_, _Nearest-neighbor mixture processes [@zheng2023nearest]_\n\n* Mixed/fused data\n\n    * _\"Aggregated\" GP ([AGP]{.important2}) [@moraga2017geostatistical]_:\n      $$\n      Z(\\mathbf{s}_i)\n      = \\begin{cases}\n      Z(\\mathbf{s}_i), & \\text{if } \\mathcal{A}(\\mathbf{s}_i) = 0 \\\\\n      {\\mathcal{A}(\\mathbf{s}_i)}^{-1}\n      \\int_{\\mathcal{A}(\\mathbf{s}_i)} Z(\\mathbf{s}) \\dd \\mathbf{s}, & \\text{if }\n      \\mathcal{A}(\\mathbf{s}_i) > 0\n      \\end{cases}\n      $$\n\n::: {.notes}\n\n- Areal models are usually heteroscedastic; The marginal variances decrease with\n  the number of neighbors;\n  \n- Data fusion models are also heteroscedastic (unless all the polygons are of\n  the same size); computationally prohibitive for moderately large datasets;\n  arbitrary choice of grid resolution.\n\n:::\n\n## Research Questions\n\n- The main [research questions]{.important} we are interested in are:\n\n  1. Can we propose a [model]{.important} for spatial data that accomodates\n     [areal, point-referrenced, and fused data]{.important}?\n\n  1. If so, is this model [competitive]{.important} when compared [to\n     specialized models]{.important}?\n\n- [Proposal]{.important2}: An [isotropic]{.important} GP defined on a [flexible\n  index set]{.important}.\n\n- [Main challenge]{.important2}: Defining a [valid correlation\n  function]{.important}.\n\n<!-- - The robustness of the method is showcased by two simulation studies and three -->\n<!--   applications. -->\n\n# Hausdorff--Gaussian Process (HGP) {.section_slide visibility=\"uncounted\"}\n\n## Preliminaries {.center}\n\n- [Point-referenced]{.important} and [areal]{.important} spatial units\n  [are]{.important} (closed and bounded) [sets]{.important}.\n\n\n- We need to generalize distance between points to [distance between\n  sets]{.important}.\n  \n  \n- Ideally, this distance should: \n  1. [Take into account]{.important} the [shape, size, and\n     orientation]{.important} of spatial sample units.\n  2. Be [\"spatially interpretable\"]{.important}.\n\n\n## Distances between sets\n\n- [Metric space]{.important2}: $(D, d)$, where $D$ is a spatial region of\n  interest.\n\n- [Distance between a point and a set]{.important2}: $d(x, A) = \\inf_{a \\in A}\n  d(x, a)$, where $d(x, y)$ is the distance between any two elements $x, y \\in\n  D$\n\n- [Directed Hausdorff distance]{.important2}: $${\\vec h}(A, B) = \\sup_{a \\in A}\n  d(a, B)$$\n\n- [Hausdorff distance]{.important2}: $$h(A, B) = \\max \\left \\{ \\vec{h}(A, B),\n  \\vec{h}(B, A) \\right \\}$$\n\n:::{.notes}\n\n- Note that if $A$ and $B$ are both singletons, then $h(A, B) = d(A, B)$.\n\nMeric Properties: (1) Symmetry: $d(x, y) = d(y, x)$; (2) Nonnegativeness: $d(x,\ny) \\geq 0$ and $d(x, x) = 0$; (3)Positiveness: $d(x, y) = 0 \\implies x = y$; (4)\nTriangle inequality: $d(x, y) \\leq d(x, z) + d(z, y)$\n\n\n:::\n\n\n## Hausdorff Distance for Spatial Data Analysis\n\n- [Study region]{.important2}: In spatial statistics, $D$ is tipically a [closed\n  and bounded]{.important} subset of $\\mathbb{R}^2$.\n\n- In this context, the [Hausdorff distance is a metric]{.important}\n  [Appendix C, @molchanov2005theory].\n\n\n\n::: {.cell layout-ncol=\"3\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/haus-dist-1.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/haus-dist-2.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/haus-dist-3.png){width=960}\n:::\n:::\n\n\n\n:::{.notes}\n\n- Metric on $D \\setminus \\varnothing$\n\n- The Hausdorff distance ability to account for spatial units' [shapes, sizes\n  and orientation]{.important}[@min2007extended] renders it an interesting tool\n  to achieve our goals.\n\n- Moreover, it can [distinguish]{.important} between [overlapping, nested, and\n  disjointed regions]{.important}.\n\n- In the figure: (1) The dashed lines denote the Hausdorff distances; (2) The\n  infimum distance between to sets is zero for the three cases; (3) Distance\n  between centroids is the same for the first two figures.\n\n:::\n\n\n## The HGP\n\n\n* [Index set]{.important2}: $\\mathcal{B}(D)$ represents the [closed and\n  bounded]{.important} subsets of $D \\subset \\mathbb{R}^2$.\n\n* $Z(\\mathbf{s}) \\sim \\mathrm{HGP}\\{m(\\mathbf{s}), v(\\mathbf{s}), r(h)\\}$, where\n  $\\mathbf{s} \\in \\mathcal{B}(D)$.\n\n- [Mean function]{.important2}:\n  $m(\\mathbf{s}) = \\E[Z(\\mathbf{s})]$\n  \n- [Covariance function]{.important2}: $\\mathrm{Cov}(Z(\\mathbf{s}_1),\n  Z(\\mathbf{s}_2)) = v(\\mathbf{s}_1) v(\\mathbf{s}_2) r(h(\\mathbf{s}_1,\n  \\mathbf{s}_2))$\n  \n- [SD function]{.important2}: $v(\\mathbf{s}) =\n  \\sqrt{\\mathrm{Var}(Z(\\mathbf{s}))}$ \n  \n- [Correlation function]{.important2}: $r(h) =\n  \\mathrm{Cor}(Z(\\mathbf{s}_1), Z(\\mathbf{s}_2)),$ where $h$ denotes the\n  [Hausdorff distance]{.important} between $\\mathbf{s}_1, \\mathbf{s}_2 \\in\n  \\mathcal{B}(D)$.\n\n\n:::{.notes}\n\n- Ideally, we want bounded, compact, and non-empty sets for the Hausdorff\n  distance to be a metric..\n\n- In $\\mathbb{R}^2$, a compact subset is bounded.\n\n- empty is a subset of any set -> it is bounded bc a subset of a bounded set is\n  bounded itself.\n\n- Mean and SD functions can be informed by covariates.\n\n- The ensure the validity of the process, the function $r(\\cdot)$ must be\n  positive definite.\n\n- Complex functional parametric space. \n\n- Inference is simplified (or possible) by assuming parametric forms to those\n  functions.\n\n\n- Mean and SD functions can be informed by covariates.\n\n- The ensure the validity of the process, the function $r(\\cdot)$ must be\n  positive definite.\n\n- Complex functional parametric space. \n\n- Inference is simplified (or possible) by assuming parametric forms to those\n  functions.\n\n- The SD function allows the HGP to accommodate both [homoscedastic and\n  heteroscedastic scenarios]{.important}.\n\n:::\n\n\n## The $v(\\mathbf{s})$ function\n\n\nWe may defined: $$v(\\mathbf{s}) = \\exp \\{ \\alpha_0 + \\alpha_1 w(\\mathbf{s})\n\\},$$ where $w(\\mathbf{s})$ is a covariate available for any $\\mathbf{s} \\in\n\\mathcal{B}(D)$.\n\n- Useful special cases:\n\n    - [Homoscedastic]{.important2}: $w(\\mathbf{s}) = 0$ (consequence, $\\sigma =\n      \\exp \\{ \\alpha_0 \\}$)\n\n    - [Data Fusion]{.important2}: $w(\\mathbf{s}) =\n      \\mathbb{1}(\\mathcal{A}(\\mathbf{s}) > 0)$.\n    \n    - [Area dependent]{.important2}: $w(\\mathbf{s}) = \\mathcal{A}(\\mathbf{s})$\n\n- Although flexible, one has to be [careful]{.important} when choosing this\n  function to ensure the [process validity]{.important} [@palacios2006non].\n\n::: {.notes}\n\n- for data fusion: $\\sigma_a = \\exp \\{ \\alpha_0 + \\alpha_1 \\}$.\n\n:::\n\n\n## Ensuring the process' validity\n\nFor a valid process, its [correlation function]{.important} must satisfy the following\nproperties:\n  \n\n- [Diminish with increasing distance]{.important2}: $\\lim_{h \\to \\infty}r(h) = 0$.\n\n\n- [Bounded from above by 1]{.important2}: $r(0) = 1$.\n\n\n- [Positive definiteness (PD)]{.important2}: yields positive definite [correlation\n  matrices]{.important} for all its finite-dimensional marginal distributions.\n\n\n- Unfortunately, functions that are [guaranteed]{.important} to be\n  [positive definite]{.important} on [$(\\mathbb{R}^2, \\lVert \\cdot\n  \\rVert_2)$]{.important} are [not]{.important} necessarily positive definite on\n  [other metric spaces]{.important} [@li2023inference].\n\n## PD and Empirical Assessment\n\n- [Definition]{.important2}: A real function $k$ on a metric space $(D, d)$ is\n  [PD]{.important} if it is continuous and satisfies:\n  \n  $$ \\sum_{i = 1}^{m} \\sum_{j = 1}^{m} a_i a_j k(\\mathbf{s}_i, \\mathbf{s}_j)\n\\geq 0 $$ \n  \n  for real numbers $a_1, \\ldots, a_m$ and $\\mathbf{s}_1, \\ldots, \\mathbf{s}_m\n  \\in D$.\n\n- [Necessary condition]{.important2}: All the [eigen values]{.important} of the\n  resulting correlation matrix must be [non-negative]{.important}.\n  \n- [Empirical assessment]{.important2}: We can check for [PD]{.important} by\n  examining the [smallest eigenvalue]{.important} of the [correlation\n  matrix]{.important} across the parameter space.\n\n## The Powered Exponential Correlation (PEC) Function\n\n- [PEC function]{.important2}: $$r(h; \\phi, \\nu) = \\exp\\left \\{ -\n  \\frac{h^{\\nu}}{\\phi^{\\nu}}\\right \\},$$ where $\\nu$ is a [smoothness\n  parameter]{.important} and $\\phi$ governs the range of the [spatial\n  dependence]{.important}.\n\n:::{.incremental}\n- [Parametrization]{.important2}: We reparametrize this function with $\\rho =\n  {\\log(10)}^{1 / \\nu} \\phi$.\n\n- [Interpretation]{.important2}: $\\rho$ is the [distance]{.important} at which\n  the [spatial correlation reduces to $0.10$]{.important}.\n:::\n\n::: {.notes}\n\n- explain $\\rho$.\n\n:::\n\n\n## Visualizing the PEC function\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/pec-function-1.png){width=960}\n:::\n:::\n\n\n\n## Empirical Assessment of PEC's Positive Definiteness\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/psd-empirical-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n:::{.notes}\n\n- the graph displays the smallest eigenvalue of the correlation matrix induced\n  by $\\rho$ (x-axis) and $\\nu$ (y-axis).\n  \n- These matrices are based on the two spatial applications we will discuss in\n  the next chapter.\n  \n- The transparent regions indicate the regions of the parametric space where rho\n  is smaller than 0.\n\n:::\n\n## HGP Recap\n\n- [Flexibility]{.important2}: A process that handles [point-referrenced, areal,\n  and mixed spatial data]{.important} by construction.\n\n- [Hausdorff distance]{.important2}: Enables HGP's correlation function to\n  account for the [shape, size, and orientation]{.important} of spatial objects.\n\n- [PEC Function Validity]{.important2}: A [valid HGP]{.important} depends on\n  selecting an [appropriate PEC correlation]{.important} function.\n  \n- [Empirical assessments]{.important2}: When analyzing a [new dataset or trying\n  a new correlation function]{.important}, it is imperative to [empirically\n  assess the validity]{.important} of the function.\n\n\n\n```{mermaid}\n%%| fig-align: center\nflowchart LR\n    A(Flexible index set) ==> B(GP)\n    B ==> E(((HGP)))\n    C(Hausdorff distance) ==> D(PEC)\n    D ==> E\n```\n\n\n\n\n# Spatial modeling {.section_slide visibility=\"uncounted\"}\n\n\n## Spatial GLMM\n\nA generalized linear mixed effects model ([GLMM]{.important}) can be written as\n$$\\begin{aligned}\n& Y(\\mathbf{s}_i) \\mid \\mathbf{x}_i, Z(\\mathbf{s}_i) \\overset{{\\rm ind}}{\\sim}\n  f(\\cdot \\mid \\mu_i, \\boldsymbol{\\gamma}) \\\\\n& g(\\mu_i) = \\mathbf{x}_i \\boldsymbol{\\beta} +\n  Z(\\mathbf{s}_i).\n\\end{aligned}$$\n\n- [Probability distribution]{.important2}: $f(\\cdot)$\n\n- [Conditional mean]{.important2}: $\\mu_i = \\E[Y(\\mathbf{s}_i) \\mid\n  \\mathbf{x}_i, Z(\\mathbf{s}_i)]$\n\n- [Link function]{.important2}: $g(\\cdot)$\n\n- [Model parameters]{.important2}: $\\boldsymbol{\\theta} =\n  {\\{\\boldsymbol{\\beta}^\\top, \\boldsymbol{\\sigma}^\\top,\n  \\boldsymbol{\\delta}^\\top, \\boldsymbol{\\gamma}^\\top \\}}^\\top$\n  \n- [Joint density]{.important2}: $p(\\mathbf{y} \\mid \\mathbf{z}, \\boldsymbol{\\theta}) =\n  \\prod_{i = 1}^n f(y(\\mathbf{s}_i) \\mid \\mu_i, \\boldsymbol{\\gamma})$\n\n:::{.notes}\n\n- Realizations of random variables are represented by lowercase letters.\n\n- Model paramers are greek letters.\n\n- Under a frequentist perspective, we consider the random effects to follow an\n  HGP.\n  \n- For Bayesian inference, we use the HGP as a prior for the random effects.\n\n- Response variable $Y$ at a spatial unit $s$ is modeled with an appropriate\n  distribution (e.g., Poisson, Bernoulli).\n\n- Covariates ($X$) and spatial random effects ($Z$) explain variation in the\n  conditional mean ($\\mu$).\n\n- The HGP defines the spatial random effects ($Z$), capturing spatial\n  correlation with the Hausdorff distance and a correlation function.\n\n:::\n\n## Priors\n\n- Independent normal priors for the [regression coefficients]{.important}:\n$\\boldsymbol{\\beta} \\sim \\mathcal{N}(\\mathbf{0}, 10 \\mathbf{I})$\n  \n  \n- HGP prior for the [latent random effects]{.important}: $\\mathbf{Z} \\sim\n  \\mathrm{HGP}\\{0, v(\\cdot), r(\\cdot) \\}$\n\n\n- Exponential prior for the [spatial dependence]{.important} parameter: $\\rho\n\\sim \\mathrm{Exp}(a_\\rho)$, where $a_{\\rho} = - \\log(p_{\\rho}) / \\rho_0$. \n    - $a_\\rho$ is chosen such that $\\mathbb{P}(\\rho \\geq \\rho_0) = p_\\rho$.\n\n\n- [Homoscedastic variance]{.important2}: $v(\\mathbf{s}) =\n  \\sqrt{\\mathrm{Var}(Z(\\mathbf{s}))} = \\sigma \\sim t_{+}(3)$\n\n\n- [Heteroscedastic HGP]{.important2}: $\\alpha \\sim \\mathcal{N}(\\mathbf{0},\n\\mathbf{I})$, where $v(\\mathbf{s}) = \\exp \\{ \\alpha_0 + \\sum_i \\alpha_i w_i(\\mathbf{s}) \\}$.\n\n:::{.notes}\n\n- For $\\rho$, the prior is inspired in penalized complexity priors. A\n  conservative, but reasonable, choice for its hyperparameter is setting\n  $a_\\rho$ such that $\\rho_0$ is a surprisingly low practical range and $p_rho$\n  is a small probability (i.e., around .01)\n\n:::\n\n## Bayesian Inference \\& Model Assessment\n\n\n- [Posterior]{.important2}: $\\pi(\\boldsymbol{\\theta} \\mid \\mathbf{y},\n  \\mathbf{z}) \\propto p(\\mathbf{y} \\mid \\mathbf{z}, \\boldsymbol{\\theta})\n  p(\\mathbf{z} \\mid \\boldsymbol{\\theta}) \\pi(\\boldsymbol{\\theta})$\n\n- [MCMC sampler]{.important2}: No-U-Turn [@hoffman2014no].\n\n- [Convergence assessment]{.important2}: traceplots and split-${\\hat{R}}$\n  [@vehtari2021rank].\n\n- [Goodness-of-fit criteria]{.important2}: LOOIC ([lower values indicate better\n  fit]{.important})\n  \n- [Posterior predictive distributions]{.important2}: $p(\\mathbf{y}^{\\ast} \\mid\n  \\mathbf{y})$\n\n- [Predictions assessment]{.important2}: Interval Score (IS) and RMSP ([lower\n  values indicate better fit]{.important})\n\n\n:::{.notes}\n\n- Point and interval estimates: median and percentiles ($0.025$\n  and $0.975$) of the marginal MCMC samples.\n  \n- Parameters initialized by random sampling from their priors.\n\n- Random effects initialized from a standard normal distribution.\n\n- $a_\\rho$ is chosen so that: $\\mathbb{P}(\\rho > U) = p_\\rho$. In particular,\n  $a_\\rho = - \\log(p_\\rho) / \\rho_0$.\n\n- $\\nu$ hard to be estimated.\n\n\n\nPredictions:\n\n1. use the properties of GP and multivariate Normal distribution to obtain the\n   closed-form distribution of the vector of spatial random effects\n   $\\mathbf{Z}^\\ast$ [@diggle1998model];\n\n2. sample $\\mathbf{z}^\\ast_{(b)}$ from the distribution derived in the previous\n   step;\n\n3. sample $\\mathbf{y}^{\\ast}_{(b)}$ from $p(\\mathbf{y}^{\\ast} \\mid \\boldsymbol{\\theta}_{(b)},\n   \\mathbf{z}^{\\ast}_{(b)})$, where $\\boldsymbol{\\theta}_{(b)}$ is the $b$-th MCMC sample of\n   $\\boldsymbol{\\theta}$.\n\n:::\n\n\n## Bayesian Modeling Recap {.center}\n\n\n- [HGP]{.important} as a prior for the random effects disribution in a\n  [GLMM]{.important}.\n  \n- Bayesian inference through [MCMC]{.important}.\n\n- Uncertainty quantification of predictions through the [posterior predictive\n  distributions]{.important}.\n\n\n:::{.notes}\nDAGAR priors:\n$$\n\\begin{aligned}\n  \\pi(\\beta_0) & \\propto 1 \\\\\n  \\beta_1 & \\sim N(0, 1000^2) \\\\\n  \\tau & \\sim Gamma(2, 1) \\\\\n  \\psi & \\sim U(0, 1).\n\\end{aligned}\n$$\n- Precision matrix is defined based on the order of the observations and\nadjacency matrix (and the two parameters)\n:::\n\n\n# Areal Data Application {.section_slide visibility=\"uncounted\"}\n\n## Respiratory Disease Hospitalization in Glasgow\n\n\n\n::: {.cell layout-align=\"center\" crop='true'}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/sirobs-1.png){fig-align='center' width=9000}\n:::\n:::\n\n\n\n## Respiratory Disease Hospitalization in Glasgow\n\n\n$$\\begin{aligned}\n& (Y(\\mathbf{s}_i) \\mid x_i, z(\\mathbf{s}_i)) \\sim \\text{Poisson}(E_i \\mu_i) \\\\\n& \\log(\\mu_i) = \\beta_0 + x_i \\beta_1 + z(\\mathbf{s}_i)\n\\end{aligned}$$\n\n\n- [Sample units]{.important2}: 134 intermediate zones (IZ), where the $i$-th IZ\n  is denoted $\\mathbf{s}_i$.\n\n- [Number of hospitalizations]{.important2}: $\\mathbf{Y} = {(Y(\\mathbf{s}_1),\n  \\ldots, Y(\\mathbf{s}_n))}^\\top$.\n\n- [Expected number of hospitalizations]{.important2} based on the national age-\n  and sex-standardized rates: $E_i$.\n\n- [Percentage of people]{.important} classified as [income\n  deprived]{.important}: $x_i$.\n\n\n:::{.notes}\n\n- Data from the north portion of the river Clyde in the Great Glasgow and Clyde\n  health board in Scotland.\n\n- Assumption: Conditional on $\\mathbf{Z}$, $\\mathbf{Y}$ are mutually\n  independent.\n\n- Explain goals of the analysis--estimate risks adjusted for income deprivation,\n  compare methods.\n\n- $\\mu_i$ is the expected SIR at region $i$.\n\n- Outline the modeling choices (HGP, DAGAR, BYM), briefly mention priors.\n\n:::\n\n\n## Disease Mapping: Estimation \\& GOF\n\n:::{.fw}\n\n|           | HGP                               | DAGAR                             |\n|:----------|:----------------------------------|:----------------------------------|\n| $\\beta_0$ | -0.21 (-0.268, -0.139)            | -0.26 (-0.450, -0.137)            |\n| $\\beta_1$ | 0.33 (0.284, 0.368)               | 0.31 (0.258, 0.370)               |\n| $\\sigma$  | 0.19 (0.155, 0.234)               | 0.30 (0.218, 0.484)               |\n| $\\rho$    | [2.25 (0.159, 6.948)]{.important} |                                   |\n| $\\psi$    |                                   | [0.43 (0.069, 0.827)]{.important} |\n|           |                                   |                                   |\n|           |                                   |                                   |\n| LOOIC     | [1081.0]{.important}              | 1081.9                            |\n\n: {.striped}\n\n:::\n\n\n:::{.notes}\n\n- median (95% CI)\n\n- similar estimates for covariate\n\n- HGP indicates weak spatial correlation\n\n- DAGAR and BYM spatial dependence are not helpful as they indicate the spatial\n  correlation goes from weak to strong (according to the CI)\n\n:::\n\n\n## Disease Mapping: Spatial Dependence\n\n\n\n::: {.cell layout-align=\"center\" crop='true'}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/scotrho-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n:::{.notes}\n\n- HGP provides more insight into spatial dependence\n\n- We could also plot the correlation function itself\n\n:::\n\n\n## Disease Mapping: Adjusted SIR {.center}\n\n\n\n::: {.cell layout-align=\"center\" crop='true'}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/sirfit-1.png){fig-align='center' width=9000}\n:::\n:::\n\n\n\n:::{.notes}\n\n- Fitted values are similar among the three models\n\n- Some regions with very low risks are shrunk toward a \"regional mean\"\n\n:::\n\n# Data Fusion Application {.section_slide visibility=\"uncounted\"}\n\n## Air Pollution in Ventura and Los Angeles\n\n::: {layout=\"[ 0.5, -0.05, 0.45 ]\"}\n\n::::{#first-column}\n\n$$(Y(\\mathbf{s}_i) \\mid z(\\mathbf{s}_i)) \\sim\n  \\mathcal{N}(\\beta_0 + z(\\mathbf{s}_i), \\tau^2)$$\n\n\n- [PM~2.5~]{.important2}: $\\mathbf{Y} = {(Y(\\mathbf{s}_1), \\ldots,\n  Y(\\mathbf{s}_n))}^\\top$.\n\n- [Point-referrenced data]{.important2} from 19 measurement stations available\n  daily from 1999 to date;\n\n- [Satellite-derived]{.important2} estimates (2010--2012) at 184 areal units.\n\n::::\n\n::::{#second-column}\n\n\n\n::: {.cell layout-align=\"center\" crop='true'}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/pm25-map1-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n::::\n\n:::\n\n:::{.notes}\n\n- goals: (1); estimate model parameters using both sources. (2) use satellite\n  data to help with interpolation.\n\n- square areas (average size $\\approx$ 101.95 km^2^)\n\n- data fusion challenges\n\n- adaptability of the hgp to different problems.\n\n- Pm25 scale is micrometre per cubic meter: one one-millionth of a meter.\n\n- conditional on $z$ the $y$s are mutually independent.\n\n- Priors on random effects: AGP1 and 2; heteroscedastic HGP with different\n  variances for areal and point-referrenced data.\n\n:::\n\n## AGP Approximation  {.section_slide visibility=\"uncounted\"}\n\n\n\n::: {.cell layout-ncol=\"2\" layout-align=\"center\" crop='true'}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/meshes-lam-1.png){fig-align='center' width=960}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/meshes-lam-2.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Air Pollution: Estimation and Prediction Assessment {.center transition=\"zoom-in slide-out\" transition-speed=\"slow\"}\n\n:::{.fw}\n\n|            | HGP                               | $\\rm AGP_1$                       | $\\rm AGP_2$                     |\n|:-----------|:----------------------------------|:----------------------------------|:--------------------------------|\n| $\\beta$    | 5.61 (4.69, 6.45)                 | 6.22 (2.16, 10.10)                | 6.19 (5.88, 6.48)               |\n| $\\rho$     | [13.83 (7.82, 23.61)]{.important} | [13.16 (5.14, 30.24)]{.important} | [0.63 (0.46, 0.83)]{.important} |\n| $\\tau$     | 0.18 (0.07, 0.31)                 | 1.39 (1.24, 1.56)                 | 0.54 (0.39, 0.72)               |\n| $\\sigma$   | 3.85 (2.92, 5.18)                 | 1.70 (0.96, 2.91)                 | 2.41 (2.024, 2.84)              |\n| $\\sigma_a$ | 1.24 (1.04, 1.51)                 |                                   |                                 |\n|            |                                   |                                   |                                 |\n|            |                                   |                                   |                                 |\n| RMSP       | [1.05]{.important}                | 1.45                              | 1.64                            |\n| Width      | 3.57                              | [2.53]{.important}                | 9.67                            |\n| CPP        | 95.5                              | 78.6                              | 95.5                            |\n| IS         | [4.80]{.important}                | 15.11                             | 13.65                           |\n\n: {.striped}\n\n:::\n\n:::{.notes}\n\n- $\\rho$ rescaled to 100s of km.\n\n- staggering difference in estimates of the same model with different meshes.\n\n:::\n\n## Air Pollution: Change-of-Support\n\n\n\n\n::: {.cell layout-align=\"center\" crop='true'}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/lacos-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n:::{.notes}\n\n- Figure confirms what we learned from 10-fold CV and simulation studies.\n\n- HGP allows to use data from different sources seamlessly\n\n- No dependence on meshes/grids\n\n- Apparently, a parsimonious compromise between the two meshes.\n\n- Once again, the AGP seems highly dependend on the mesh and this is not\n  highlighted in the literature.\n\n:::\n\n\n## Applications: key findings\n\n\n- The proposed method consistently demonstrated [performance comparable to\n  specialized models]{.important} tailored for areal and fused data.\n  \n- Unlike traditional areal models, the HGP's [marginal variances]{.important}\n  are [independent]{.important} of the [number of neighbors]{.important}.\n  \n- The HGP model [simplifies data fusion]{.important} by [bypassing]{.important}\n  the need to define [arbitrary grids]{.important} for [numerical\n  integral]{.important} evaluation, eliminating this step each time the joint\n  probability distribution of the data and parameters is calculated.\n  \n- Across both applications, the HGP provides an [interpretable spatial\n  dependence]{.important} parameter and a spatial correlation function.\n\n\n# Closing remarks {.section_slide visibility=\"uncounted\"}\n\n## Highlights\n\nThe HGP has proven to be a powerful model that offers:\n\n- [Versatility]{.important2}: accomodates diverse spatial data types.\n\n- [Performance]{.important2}: competitive against models designed for specific\n  spatial data types.\n\n- [Reliable predictions]{.important2}: prediction intervals with near nominal\n  frequentist coverage.\n\n- Our conclusions are further supported by a comprehensive [simulation\n  study]{.important}, detailed in our available\n  [preprint](https://arxiv.org/abs/2208.07900).\n\n::: {.notes}\n\nKey Takeaway: The HGP's versatility and performance make it a valuable tool in\nyour spatial analysis toolkit.\n\n:::\n\n## Future work and Limitations\n\n- [Extensions]{.important2}: \n  - non-Euclidean spaces\n  - Big data\n\n- [Limitations]{.important2}: \n  - Big \"n\" problem inherited from geostatistics\n  - Unclear how to incorporate anisotropy \n  - Difficulties in obtaining spectral densities for correlation functions\n\n---\n\n### References {visibility=\"uncounted\"}\n\n<div id=\"refs\"></div>\n\n# Thank you! {.unlisted .section_slide visibility=\"uncounted\"}\n\n![](qr-code-end.png){fig-align=\"center\"}\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}